<!DOCTYPE html>
<html lang="en">
<title>Kafka</title>
<link rel="shortcut icon" type="image/x-icon" href="./scripts/images/tab_logo.png"/>
<div id="header"></div>
<body>
<div class="body">
    <div class="nav-container">
        <aside class="nav">
            <div class="nav-panel-menu is-active" data-panel="menu">
                <li class="nav-item" data-depth="0">
                    <ul class="nav-list">
                        <h4>Tutorials</h4>
                        <li class="nav-item"><a class="nav-link" href="./kafka.html">Kafka</a></li>
                    </ul>
                </li>
            </div>
        </aside>
    </div>
    <main class="article">
        <div class="toolbar">
            <button class="navbar-burger" id="nav-toggle-1">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <nav class="breadcrumbs">
                <h4>Kafka</h4>
            </nav>
        </div>
        <div class="doc">
            <nav class="breadcrumbs div-to-hide">
                <h4>Kafka</h4>
            </nav>
            <a class="div-to-desk"> <br> </a>
            <article>
                <div class="entry-content" itemprop="text">
                    <div class="ak-renderer-document">
                        <h3 id="1.-Introduction-to-Apache-Kafka" data-renderer-start-pos="1"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">1. Introduction to Apache Kafka</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h3>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="34">Apache Kafka is an <strong data-renderer-mark="true">open-source,
                            distributed event streaming platform</strong> designed for high-performance data pipelines,
                            streaming analytics, data integrations, and mission-critical applications. It's optimized
                            for ingesting and processing streaming data in real-time.</p>
                        <p data-renderer-start-pos="298"><strong data-renderer-mark="true">Event streaming</strong> is
                            defined as "the practice of capturing the data in real time from event sources like
                            databases, sensors, mobile devices, cloud services, and software applications in in the form
                            of streams of events."</p>
                        <h3 id="2.-Key-Features-and-Advantages-of-Kafka" data-renderer-start-pos="518"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">2. Key Features and Advantages of Kafka</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h3>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="559">Kafka boasts several powerful features that make it a robust
                            solution for real-time data processing:</p>
                        <ol class="ak-ol" data-indent-level="1" start="1">
                            <li><p data-renderer-start-pos="663"><strong data-renderer-mark="true">High
                                Scalability:</strong> Kafka is designed for <strong data-renderer-mark="true">horizontal
                                scalability</strong>, allowing it to handle massive amounts of data by adding more
                                hardware or nodes to a cluster without downtime.</p></li>
                            <li><p data-renderer-start-pos="840"><strong data-renderer-mark="true">High Throughput &amp;
                                Low Latency:Throughput</strong> is "a measure of how many units of information a system
                                can process in a given amount of time." Kafka can handle "millions of messages per
                                second."</p></li>
                            <li><p data-renderer-start-pos="1032"><strong data-renderer-mark="true">Latency</strong> is
                                "the delay in the network communication." Kafka achieves low latency (as low as 2
                                milliseconds max) by storing data in memory, enabling quick read and write operations.
                            </p></li>
                            <li><p data-renderer-start-pos="1215"><strong data-renderer-mark="true">Distributed
                                Systems:</strong> Kafka's distributed architecture ensures <strong
                                    data-renderer-mark="true">fault tolerance and reliability</strong>. Data is
                                distributed across multiple nodes, reducing the risk of data loss.</p></li>
                            <li><p data-renderer-start-pos="1388"><strong data-renderer-mark="true">Publish-Subscribe
                                Messaging System:</strong> Kafka operates as a pub-sub system where "producer can
                                publish the messages or data to the topics and consumer subscribes to those topics to
                                receive the data."</p></li>
                            <li><p data-renderer-start-pos="1587"><strong data-renderer-mark="true">Retention and
                                Durability:</strong> Kafka offers <strong data-renderer-mark="true">configurable
                                retention periods</strong> for messages, ensuring data durability over time. Data can be
                                stored for a specified duration or size, allowing for data replay or reprocessing.</p>
                            </li>
                            <li><p data-renderer-start-pos="1805"><strong data-renderer-mark="true">Support for Stream
                                Processing:</strong> Kafka provides a streaming platform for building real-time data
                                pipelines and applications, with the Kafka Streams API enabling processing within its
                                ecosystem.</p></li>
                            <li><p data-renderer-start-pos="2000"><strong data-renderer-mark="true">Connectivity and
                                Integrations:</strong> Kafka supports connectors for seamless integration with various
                                data sources and sinks, facilitating data transfer between systems.</p></li>
                        </ol>
                        <h3 id="3.-Kafka-Use-Cases" data-renderer-start-pos="2166"><span data-renderer-mark="true"
                                                                                         data-background-custom-color="#c6edfb"
                                                                                         class="fabric-background-color-mark"
                                                                                         style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">3. Kafka Use Cases</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h3>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="2186">Kafka is widely used across various industries for:</p>
                        <ol class="ak-ol" data-indent-level="1" start="1">
                            <li><p data-renderer-start-pos="2241"><strong data-renderer-mark="true">Financial
                                Transactions:</strong> Processing payments and financial transactions in real-time
                                (e.g., stock exchanges, banks, insurance).</p></li>
                            <li><p data-renderer-start-pos="2371"><strong data-renderer-mark="true">Logistics &amp;
                                Automotive:</strong> Tracking and monitoring parts, shipments, and vehicles in
                                real-time.</p></li>
                            <li><p data-renderer-start-pos="2467"><strong data-renderer-mark="true">IoT Data:</strong>
                                Continuously capturing and analyzing sensor data from IoT devices and other equipment
                                (e.g., factories, wind parks).</p></li>
                            <li><p data-renderer-start-pos="2597"><strong data-renderer-mark="true">E-commerce &amp;
                                Retail:</strong> Collecting and reacting to customer interactions in real-time (e.g.,
                                e-commerce, order processing, hotel/travel).</p></li>
                            <li><p data-renderer-start-pos="2735"><strong data-renderer-mark="true">Healthcare:</strong>
                                Monitoring patients and predicting condition changes for timely treatment in
                                emergencies.</p></li>
                            <li><p data-renderer-start-pos="2840"><strong data-renderer-mark="true">Data
                                Integration:</strong> Connecting, storing, and making data available across different
                                company divisions.</p></li>
                            <li><p data-renderer-start-pos="2944"><strong data-renderer-mark="true">Architectural
                                Foundations:</strong> Serving as the foundation for data platforms, event-driven
                                architectures, and microservices.</p></li>
                        </ol>
                        <h3 id="4.-Kafka-Key-Components" data-renderer-start-pos="3067"><span data-renderer-mark="true"
                                                                                              data-background-custom-color="#c6edfb"
                                                                                              class="fabric-background-color-mark"
                                                                                              style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">4. Kafka Key Components</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h3>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="3092">Understanding these core concepts is crucial for working with
                            Kafka:</p>
                        <p data-renderer-start-pos="3162"><strong data-renderer-mark="true">1. Kafka Clusters:</strong>
                            A set of Kafka brokers working together. One broker acts as a <strong
                                    data-renderer-mark="true">controller</strong> to manage cluster metadata.</p>
                        <p data-renderer-start-pos="3283"><strong data-renderer-mark="true">2. Brokers:</strong> A
                            <strong data-renderer-mark="true">Kafka server</strong> that stores data and serves clients.
                            A Kafka cluster consists of multiple brokers for load balancing. Brokers are stateless and
                            use replication for fault tolerance and data durability.</p>
                        <p data-renderer-start-pos="3496"><strong data-renderer-mark="true">3. Topics:</strong> A
                            <strong data-renderer-mark="true">logical channel</strong> to which messages are sent and
                            from which messages are consumed. It can have multiple <strong data-renderer-mark="true">partitions</strong>.
                        </p>
                        <p data-renderer-start-pos="3624"><strong data-renderer-mark="true">4. Partitions:</strong>
                            "Each topic is divided into one or more partitions. the basic unit of parallelism and
                            distribution in the cough." Messages within a partition are ordered and assigned an offset
                            for tracking.</p>
                        <p data-renderer-start-pos="3831"><strong data-renderer-mark="true">5. Partitions
                            Offset:</strong> "A unique ID for each message in a partition. Consumers use offsets to
                            track read progress." Offsets are crucial for consumers to track their position, know which
                            messages they've consumed, and resume consumption from the last committed offset if they
                            crash or restart.</p>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="4124">An <strong data-renderer-mark="true">offset</strong> is a
                            unique identifier for a message <strong data-renderer-mark="true">within a
                                partition</strong>.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="4192">Kafka stores messages in partitions in a sequential
                            log.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="4250">Each message in a partition has an increasing offset like
                            <code class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                  data-renderer-mark="true">0, 1, 2, 3, ...</code>.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="4326">Consumers <strong data-renderer-mark="true">track
                            offsets</strong> to know what message to read <strong
                                data-renderer-mark="true">next</strong>.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="4386">props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG,
                            "earliest"); </p></div>
                        <div class="pm-table-container with-shadow-observer" data-layout="custom"
                             data-testid="table-container" style="width: min(1254px, 100cqw);">
                            <div class="pm-table-sticky-scrollbar-sentinel-top"
                                 data-testid="sticky-scrollbar-sentinel-top"></div>
                            <div class="cc-12efcmn">
                                <div mode="none" data-testid="sticky-table-fixed"
                                     class="fixed-table-div-custom-table-resizing cc-1t3byut"
                                     style="--ak-renderer-sticky-header-zindex: 13; width: 1253.98px;">
                                    <div class="pm-table-container is-sticky with-shadow-observer" data-layout="center"
                                         style="width: inherit; margin-bottom: 0px;">
                                        <div class="pm-table-sticky-wrapper" style="overflow: hidden;">
                                            <table data-testid="renderer-table" data-number-column="false"
                                                   data-table-width="1254" data-layout="center"
                                                   style="margin-top: 0px;">
                                                <colgroup>
                                                    <col style="width: 120px;">
                                                    <col style="width: 632px;">
                                                </colgroup>
                                                <tbody>
                                                <tr>
                                                    <th rowspan="1" colspan="1" colorname=""
                                                        class="ak-renderer-tableHeader-sortable-column__wrapper"
                                                        data-colwidth="200" aria-sort="none">
                                                        <div class="ak-renderer-tableHeader-sortable-column"><p
                                                                data-renderer-start-pos="4455">Offset</p>
                                                            <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                                <div role="presentation">
                                                                    <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                                         role="button" tabindex="0"
                                                                         aria-label="No sort applied to the column"
                                                                         aria-disabled="false" aria-hidden="false">
                                                                        <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                            <div class="cc-btgm1o"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </figure>
                                                        </div>
                                                    </th>
                                                    <th rowspan="1" colspan="1" colorname=""
                                                        class="ak-renderer-tableHeader-sortable-column__wrapper"
                                                        data-colwidth="1054" aria-sort="none">
                                                        <div class="ak-renderer-tableHeader-sortable-column"><p
                                                                data-renderer-start-pos="4465">Description</p>
                                                            <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                                <div role="presentation">
                                                                    <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                                         role="button" tabindex="0"
                                                                         aria-label="No sort applied to the column"
                                                                         aria-disabled="false" aria-hidden="false">
                                                                        <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                            <div class="cc-btgm1o"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </figure>
                                                        </div>
                                                    </th>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="pm-table-wrapper" data-number-column="false" data-layout="center"
                                 data-autosize="false" data-table-local-id="b0f85788-e24e-48fc-9813-6f9b42a034f3"
                                 data-table-width="1254" data-vc="table-node-wrapper">
                                <div class="sentinel-left"></div>
                                <table data-testid="renderer-table" data-number-column="false" data-table-width="1254"
                                       data-layout="center">
                                    <colgroup>
                                        <col style="width: 120px;">
                                        <col style="width: 632px;">
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <th rowspan="1" colspan="1" colorname=""
                                            class="ak-renderer-tableHeader-sortable-column__wrapper" data-colwidth="200"
                                            aria-sort="none">
                                            <div class="ak-renderer-tableHeader-sortable-column"><p
                                                    data-renderer-start-pos="4455">Offset</p>
                                                <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                    <div role="presentation">
                                                        <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                             role="button" tabindex="0"
                                                             aria-label="No sort applied to the column"
                                                             aria-disabled="false" aria-hidden="false">
                                                            <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                <div class="cc-btgm1o"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </figure>
                                            </div>
                                        </th>
                                        <th rowspan="1" colspan="1" colorname=""
                                            class="ak-renderer-tableHeader-sortable-column__wrapper"
                                            data-colwidth="1054" aria-sort="none">
                                            <div class="ak-renderer-tableHeader-sortable-column"><p
                                                    data-renderer-start-pos="4465">Description</p>
                                                <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                    <div role="presentation">
                                                        <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                             role="button" tabindex="0"
                                                             aria-label="No sort applied to the column"
                                                             aria-disabled="false" aria-hidden="false">
                                                            <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                <div class="cc-btgm1o"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </figure>
                                            </div>
                                        </th>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="200"><p
                                                data-renderer-start-pos="4482"><strong data-renderer-mark="true">Earliest</strong>
                                        </p></td>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="1054"><p
                                                data-renderer-start-pos="4494">Starts consuming from the beginning of
                                            the partition (offset 0).</p></td>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="200"><p
                                                data-renderer-start-pos="4564"><strong
                                                data-renderer-mark="true">Latest</strong> (default)</p></td>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="1054"><p
                                                data-renderer-start-pos="4584">Starts consuming only <strong
                                                data-renderer-mark="true">new messages</strong> (skip old).</p></td>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="200"><p
                                                data-renderer-start-pos="4636"><strong
                                                data-renderer-mark="true">Manual</strong></p></td>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="1054"><p
                                                data-renderer-start-pos="4646">You can explicitly <strong
                                                data-renderer-mark="true">seek to a specific offset</strong> in code.
                                        </p></td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="sentinel-right"></div>
                            </div>
                            <div class="pm-table-sticky-scrollbar-container-view-page"
                                 data-vc="table-sticky-scrollbar-container"
                                 style="height: var(--ds-space-250, 20px); display: block; width: 100%; visibility: hidden; overflow-x: auto; position: sticky; bottom: var(--ds-space-0, 0px); z-index: 1;">
                                <div style="width: 100%; height: 100%;"></div>
                            </div>
                            <div class="pm-table-sticky-scrollbar-sentinel-bottom"
                                 data-testid="sticky-scrollbar-sentinel-bottom"></div>
                        </div>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="yaml" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(1ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-yaml" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token key atrule">spring</span><span
                                    class="token punctuation">:</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class="">  </span><span class="token key atrule">kafka</span><span
                                    class="token punctuation">:</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class="">    </span><span
                                    class="token key atrule">consumer</span><span
                                    class="token punctuation">:</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span><span
                                    class=""><span class="">      </span><span
                                    class="token key atrule">group-id</span><span
                                    class="token punctuation">:</span><span class=""> payment</span><span
                                    class="token punctuation">-</span><span class="">group
</span></span></span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">      </span><span class="token key atrule">auto-offset-reset</span><span
                                    class="token punctuation">:</span><span class=""> earliest  </span><span
                                    class="token comment"># or latest</span></span></span></code></span></div>
                        <p data-renderer-start-pos="4813"><strong data-renderer-mark="true">6. Producers:</strong> A
                            client that <strong data-renderer-mark="true">publishes (writes)</strong> data
                            (messages/events) to one or more Kafka <strong data-renderer-mark="true">topics</strong>.
                            Producers decide which <strong data-renderer-mark="true">partition</strong> to write to.
                            Producers send messages asynchronously and serialize data into a byte format.</p>
                        <p data-renderer-start-pos="5037">&nbsp;</p>
                        <p data-renderer-start-pos="5039"><strong data-renderer-mark="true">7. Consumers:</strong> A
                            client that <strong data-renderer-mark="true">subscribes (reads)</strong> messages from one
                            or more Kafka <strong data-renderer-mark="true">topics</strong>. Can be part of a <strong
                                    data-renderer-mark="true">consumer group</strong> for load balancing. </p>
                        <p data-renderer-start-pos="5180"> Consumers always read data from lower to higher offsets.</p>
                        <p data-renderer-start-pos="5243"> If a consumer reads from multiple partitions, message order
                            is not guaranteed across partitions.</p>
                        <p data-renderer-start-pos="5345"> Consumers deserialize data from byte format into usable data
                            structures.</p>
                        <p data-renderer-start-pos="5423"> Consumers are assigned to specific partitions for parallel
                            processing and scalability.</p>
                        <p data-renderer-start-pos="5515"> Consumers acknowledge message receipt and commit offsets to
                            ensure reliable, at-least-once message delivery.</p>
                        <p data-renderer-start-pos="5629"><strong data-renderer-mark="true">8. Acknowledgement Settings
                            (acks):</strong> Producers can configure acks to control message delivery durability and
                            reliability:</p>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="5751"><strong data-renderer-mark="true">acks=0:</strong>
                            Producer sends data without waiting for acknowledgement. Possible data loss.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="5837"><strong data-renderer-mark="true">acks=1</strong>
                            (Default in Kafka 2.0+): Leader broker acknowledges receipt. Limited data loss possible if
                            leader fails before replicas synchronize.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="5978"><strong data-renderer-mark="true">acks=all</strong>:
                            Leader waits for all in-sync replicas to acknowledge before responding to the producer. No
                            data loss.</p></div>
                        <p data-renderer-start-pos="6091"><strong data-renderer-mark="true">9. Message Keys:</strong>
                            Messages can have an optional key. If the key is null, messages are distributed evenly
                            across partitions in a round-robin fashion. If a key is provided, messages with the same key
                            are always sent to and stored in the same Kafka partition, ensuring order.</p>
                        <p data-renderer-start-pos="6364">&nbsp;</p>
                        <p data-renderer-start-pos="6366"><strong data-renderer-mark="true">10. Consumer Group:</strong>
                            "Consumers are organized into consumer groups...where each group read from a topic." A
                            consumer group can contain multiple consumers, processing subsets of messages, which
                            facilitates scalability and load distribution.</p>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="6606"><strong data-renderer-mark="true">Consumer Behavior with
                            Partitions: Single Consumer, Multiple Partitions:</strong> A single consumer in a group will
                            consume all partitions of a topic.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="6749"><strong data-renderer-mark="true">Multiple Consumers,
                            Multiple Partitions (Consumers &lt;= Partitions):</strong> Kafka auto-balances, assigning
                            partitions to consumers for load distribution. Each partition is consumed by only one
                            consumer within a group at a time.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="6969"><strong data-renderer-mark="true">Multiple Consumers,
                            Multiple Partitions (Consumers &gt; Partitions):</strong> All partitions will be consumed,
                            and any excess consumers will sit idle.</p></div>
                        <div class="fabric-editor-block-mark fabric-editor-indentation-mark" data-level="1"><p
                                data-renderer-start-pos="7109"><strong data-renderer-mark="true">Multiple Consumer
                            Groups:</strong> Each consumer group independently consumes from the topic's partitions.</p>
                        </div>
                        <div data-width="816" data-width-type="pixel" data-node-type="mediaSingle"
                             data-vc="media-single"
                             class="rich-media-item mediaSingleView-content-wrap image-center cc-w3imp6"
                             data-renderer-start-pos="7208" data-media-vc-wrapper="true">
                            <div class="cc-s7iwc">
                                <div class=" cc-1t7vnwi" data-media-badges="true" contenteditable="false"
                                     data-testid="media-badges"></div>
                                <div data-context-id="65875" data-type="file" data-node-type="media" data-width="1252"
                                     data-height="642" data-id="bf894c37-0b47-4df6-a388-b5afc13ac38b"
                                     data-collection="contentId-65875" data-file-name="file" data-file-size="1"
                                     data-file-mime-type="" data-alt="image-20250626-115842.png"
                                     data-renderer-start-pos="7209"><span
                                        class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"></span>
                                    <div id="newFileExperienceWrapper"
                                         class="_2rko1l7b _vchhusvi _kqswh2mm _ect41gqc _p12f1osq _c71l1osq _1bsb1qmm _4t3ine4n _1hlm1l1w _1rquusvi _eg5410xm _mts3kb7n _1ntskb7n _80omtlke new-file-experience-wrapper"
                                         data-testid="media-card-view" data-media-vc-wrapper="true"
                                         style="--media-wrapper-width: 1347px; --media-wrapper-height: 690.7140575079873px; font-size: 14px; line-height: 22px;">
                                        <div data-testid="media-file-card-view"
                                             class="_1reo15vq _18m915vq _2rko1sit _1e0c1txw _kqswh2mm _p12f1osq _1bsb1osq _4t3i1osq _c71l1osq media-file-card-view"
                                             data-test-status="complete"
                                             data-test-media-name="image-20250626-115842.png" data-test-progress="1"
                                             data-test-source="remote">
                                            <div data-testid="ImageRendererWrapper"
                                                 class="_kqswstnw _1bsb1osq _4t3i1osq _1e0c1txw _2lx21bp4 _1bah1h6o _4cvr1h6o">
                                                <img src="../images/kafka/1.png" alt="image-20250626-115842.png"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p data-renderer-start-pos="7211">&nbsp;</p>
                        <p data-renderer-start-pos="7213"><strong data-renderer-mark="true">11. Leader/Follower
                            Replications:</strong> Each partition has one leader and multiple followers. Leaders handle
                            all read and write requests for their partition, and followers replicate the leader's data.
                            If a leader fails, a follower becomes the new leader.</p>
                        <p data-renderer-start-pos="7463">leaders perform all reads and writes to a particular topic
                            partition. followers replicate leaders.</p>
                        <div data-width="750" data-width-type="pixel" data-node-type="mediaSingle"
                             data-vc="media-single"
                             class="rich-media-item mediaSingleView-content-wrap image-center cc-10hetb8"
                             data-renderer-start-pos="7563" data-media-vc-wrapper="true">
                            <div class="cc-o9kuod">
                                <div class=" cc-1t7vnwi" data-media-badges="true" contenteditable="false"
                                     data-testid="media-badges"></div>
                                <div data-context-id="65875" data-type="file" data-node-type="media" data-width="1200"
                                     data-height="628" data-id="cd7742d2-f7ee-43a1-bb80-b15b33fa5491"
                                     data-collection="contentId-65875" data-file-name="file" data-file-size="1"
                                     data-file-mime-type="" data-alt="image-20250719-145423.png"
                                     data-renderer-start-pos="7564"><span
                                        class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"></span>
                                    <div id="newFileExperienceWrapper"
                                         class="_2rko1l7b _vchhusvi _kqswh2mm _ect41gqc _p12f1osq _c71l1osq _1bsb1qmm _4t3ine4n _1hlm1l1w _1rquusvi _eg5410xm _mts3kb7n _1ntskb7n _80omtlke new-file-experience-wrapper"
                                         data-testid="media-card-view" data-media-vc-wrapper="true"
                                         style="--media-wrapper-width: 1347px; --media-wrapper-height: 704.93px; font-size: 14px; line-height: 22px;">
                                        <div data-testid="media-file-card-view"
                                             class="_1reo15vq _18m915vq _2rko1sit _1e0c1txw _kqswh2mm _p12f1osq _1bsb1osq _4t3i1osq _c71l1osq media-file-card-view"
                                             data-test-status="complete"
                                             data-test-media-name="image-20250719-145423.png" data-test-progress="1"
                                             data-test-source="remote">
                                            <div data-testid="ImageRendererWrapper"
                                                 class="_kqswstnw _1bsb1osq _4t3i1osq _1e0c1txw _2lx21bp4 _1bah1h6o _4cvr1h6o">
                                                <img src="../images/kafka/2.png" alt="image-20250626-115842.png"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p data-renderer-start-pos="7566">&nbsp;</p>
                        <h3 id="5.-Zookeeper-and-Kafka-(Legacy-vs.-Current)" data-renderer-start-pos="7568"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">5. Zookeeper and Kafka (Legacy vs. Current)</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h3>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <ul class="ak-ul" data-indent-level="1">
                            <li><p data-renderer-start-pos="7615"><strong data-renderer-mark="true">Zookeeper
                                (Legacy):</strong> Traditionally, Zookeeper acted as a distributed coordination service
                                in Kafka, managing and coordinating Kafka brokers. It notified producers and consumers
                                about new or failed brokers, facilitating tasks like metadata management, leader
                                election, consumer group coordination, and configuration management. Kafka would get
                                offset values from Zookeeper.</p></li>
                            <li><p data-renderer-start-pos="7990"><strong data-renderer-mark="true">Newer Versions
                                (Kafka 3.3+):</strong> "Apache Kafka 3.3 replaces Zookeeper with the new care of
                                consensus protocol," specifically <strong data-renderer-mark="true">Kaft (Kafka Raft
                                    metadata mode)</strong>. In this model, "each broker will have a Quorum controller,"
                                which handles the reading and writing of events to a dedicated metadata topic within the
                                Kafka cluster itself, eliminating the Zookeeper dependency.</p></li>
                        </ul>
                        <div data-width="882" data-width-type="pixel" data-node-type="mediaSingle"
                             data-vc="media-single"
                             class="rich-media-item mediaSingleView-content-wrap image-center cc-zdcvm4"
                             data-renderer-start-pos="8356" data-media-vc-wrapper="true">
                            <div class="cc-r6o3yn">
                                <div class=" cc-1t7vnwi" data-media-badges="true" contenteditable="false"
                                     data-testid="media-badges"></div>
                                <div data-context-id="65875" data-type="file" data-node-type="media" data-width="1024"
                                     data-height="512" data-id="b0ae7eea-3c9e-485b-a51a-ebec2b2a41bc"
                                     data-collection="contentId-65875" data-file-name="file" data-file-size="1"
                                     data-file-mime-type="" data-alt="image-20250626-120420.png"
                                     data-renderer-start-pos="8357"><span
                                        class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"></span>
                                    <div id="newFileExperienceWrapper"
                                         class="_2rko1l7b _vchhusvi _kqswh2mm _ect41gqc _p12f1osq _c71l1osq _1bsb1qmm _4t3ine4n _1hlm1l1w _1rquusvi _eg5410xm _mts3kb7n _1ntskb7n _80omtlke new-file-experience-wrapper"
                                         data-testid="media-card-view" data-media-vc-wrapper="true"
                                         style="--media-wrapper-width: 1347px; --media-wrapper-height: 673.5px; font-size: 14px; line-height: 22px;">
                                        <div data-testid="media-file-card-view"
                                             class="_1reo15vq _18m915vq _2rko1sit _1e0c1txw _kqswh2mm _p12f1osq _1bsb1osq _4t3i1osq _c71l1osq media-file-card-view"
                                             data-test-status="complete"
                                             data-test-media-name="image-20250626-120420.png" data-test-progress="1"
                                             data-test-source="remote">
                                            <div data-testid="ImageRendererWrapper"
                                                 class="_kqswstnw _1bsb1osq _4t3i1osq _1e0c1txw _2lx21bp4 _1bah1h6o _4cvr1h6o">
                                                <img src="../images/kafka/3.png" alt="image-20250626-115842.png"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr role="presentation">
                        <h3 id="6.-Spring-Boot-Kafka-Integration" data-renderer-start-pos="8360"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">6. Spring Boot Kafka Integration</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h3>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="8394">The tutorial demonstrates how to integrate Apache Kafka with
                            Spring Boot, focusing on setting up producers and consumers.</p>
                        <p data-renderer-start-pos="8517"><strong data-renderer-mark="true">Prerequisites:</strong>
                            Kafka needs to be installed and running (version 3.6.1 used, supporting Kaft).</p>
                        <h4 id="6.1-Running-Kafka-with-Kraft" data-renderer-start-pos="8612">6.1 Running Kafka with
                            Kraft<span role="presentation" class="heading-anchor-wrapper"></span></h4>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="actionscript" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(1ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-actionscript" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="">Generate Cluster </span><span
                                    class="token constant">UUID</span><span class="token punctuation">:</span><span
                                    class=""> kafka</span><span class="token operator">-</span><span
                                    class="">storage</span><span class="token punctuation">.</span><span class="">sh random</span><span
                                    class="token operator">-</span><span class="token function">uuid</span><span
                                    class=""> </span><span class="token punctuation">(</span><span class="">generates a unique identifier </span><span
                                    class="token keyword">for</span><span class=""> the cluster</span><span
                                    class="token punctuation">)</span><span class="token punctuation">.</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span>
</span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class="">Format Log Directories</span><span
                                    class="token punctuation">:</span><span class=""> kafka</span><span
                                    class="token operator">-</span><span class="">storage</span><span
                                    class="token punctuation">.</span><span class="">sh format </span><span
                                    class="token operator">-</span><span class="">t </span><span
                                    class="token xml token tag token tag token punctuation">&lt;</span><span
                                    class="token xml token tag token tag">UUID</span><span
                                    class="token xml token tag token punctuation">&gt;</span><span
                                    class=""> </span><span class="token operator">-</span><span class="">c </span><span
                                    class="token operator">&lt;</span><span class="">path_to_server</span><span
                                    class="token punctuation">.</span><span class="">properties</span><span
                                    class="token operator">&gt;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span>
</span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">Start Kafka Server</span><span
                                    class="token punctuation">:</span><span class=""> kafka</span><span
                                    class="token operator">-</span><span class="">server</span><span
                                    class="token operator">-</span><span class="">start</span><span
                                    class="token punctuation">.</span><span class="">sh </span><span
                                    class="token operator">&lt;</span><span class="">path_to_server</span><span
                                    class="token punctuation">.</span><span class="">properties</span><span
                                    class="token operator">&gt;</span></span></span></code></span></div>
                        <h4 id="6.2-Producer-Configuration-and-Service" data-renderer-start-pos="8905">6.2 Producer
                            Configuration and Service<span role="presentation" class="heading-anchor-wrapper"></span></h4>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="8945"><strong data-renderer-mark="true">Dependencies:</strong>
                            Spring Web and Kafka dependencies are required.</p>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="xml" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(1ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-xml" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token tag token tag token punctuation">&lt;</span><span
                                    class="token tag token tag">dependency</span><span
                                    class="token tag token punctuation">&gt;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class="">	</span><span
                                    class="token tag token tag token punctuation">&lt;</span><span
                                    class="token tag token tag">groupId</span><span class="token tag token punctuation">&gt;</span><span
                                    class="">org.springframework.kafka</span><span
                                    class="token tag token tag token punctuation">&lt;/</span><span
                                    class="token tag token tag">groupId</span><span class="token tag token punctuation">&gt;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class="">	</span><span
                                    class="token tag token tag token punctuation">&lt;</span><span
                                    class="token tag token tag">artifactId</span><span
                                    class="token tag token punctuation">&gt;</span><span
                                    class="">spring-kafka</span><span class="token tag token tag token punctuation">&lt;/</span><span
                                    class="token tag token tag">artifactId</span><span
                                    class="token tag token punctuation">&gt;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span><span
                                    class=""><span class=""></span><span class="token tag token tag token punctuation">&lt;/</span><span
                                    class="token tag token tag">dependency</span><span
                                    class="token tag token punctuation">&gt;</span></span></span></code></span></div>
                        <p data-renderer-start-pos="9121">&nbsp;</p>
                        <p data-renderer-start-pos="9123"><strong data-renderer-mark="true">ProducerConfiguration
                            Class: </strong>Defines three beans:</p>
                        <ol class="ak-ol" data-indent-level="1" start="1">
                            <li><p data-renderer-start-pos="9176"><strong
                                    data-renderer-mark="true">ProducerFactory:</strong> An interface used to create
                                Kafka producer instances, enabling consistent configuration across Spring Boot
                                applications. It's configured with bootstrap.servers, key.serializer, and
                                value.serializer.</p></li>
                            <li><p data-renderer-start-pos="9395"><strong
                                    data-renderer-mark="true">KafkaTemplate:</strong> Simplifies Kafka producer usage by
                                providing a higher-level abstraction for common operations like sending messages
                                (synchronously and asynchronously).</p></li>
                            <li><p data-renderer-start-pos="9565"><strong data-renderer-mark="true">NewTopic:</strong>
                                Creates a Kafka topic with specified name, number of partitions, and replication factor.
                            </p></li>
                        </ol>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token annotation punctuation">@Configuration</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class=""></span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">class</span><span
                                    class=""> </span><span class="token class-name">ProducerConfiguration</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span>
</span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span><span
                                    class=""><span class="">    </span><span
                                    class="token comment">//ProducerFactory</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span>
</span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span><span
                                    class=""><span class="">    </span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">ProducerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">producerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">Map</span><span class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">Object</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> configMaps</span><span class="token operator">=</span><span
                                    class=""> </span><span class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">HashMap</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">        configMaps</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ProducerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">BOOTSTRAP_SERVERS_CONFIG</span><span
                                    class="token punctuation">,</span><span class="token string">"localhost:9092"</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class="">        configMaps</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ProducerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">KEY_SERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">StringSerializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-11" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="11"></span><span
                                    class=""><span class="">        configMaps</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ProducerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">VALUE_SERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">StringSerializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-12" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="12"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">DefaultKafkaProducerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="">configMaps</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-13" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="13"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-14" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="14"></span>
</span><span data-testid="renderer-code-block-line-15" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="15"></span><span
                                    class=""><span class="">    </span><span
                                    class="token comment">//KafkaTemplate</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-16" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="16"></span><span
                                    class=""><span class="">    </span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-17" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="17"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">KafkaTemplate</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">kafkaTemplate</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-18" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="18"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">KafkaTemplate</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token function">producerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-19" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="19"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-20" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="20"></span>
</span><span data-testid="renderer-code-block-line-21" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="21"></span><span
                                    class=""><span class="">    </span><span
                                    class="token comment">//NewTopic</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-22" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="22"></span><span
                                    class=""><span class="">    </span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-23" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="23"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">NewTopic</span><span
                                    class=""> </span><span class="token function">paymentTopic</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-24" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="24"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">NewTopic</span><span
                                    class="token punctuation">(</span><span
                                    class="token string">"payment-topic"</span><span
                                    class="token punctuation">,</span><span class="token number">3</span><span
                                    class="token punctuation">,</span><span class="token punctuation">(</span><span
                                    class="token keyword">short</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token number">1</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-25" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="25"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-26" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="26"></span><span
                                    class=""><span class=""></span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <div class="pm-table-container with-shadow-observer" data-layout="custom"
                             data-testid="table-container" style="width: min(1254px, 100cqw);">
                            <div class="pm-table-sticky-scrollbar-sentinel-top"
                                 data-testid="sticky-scrollbar-sentinel-top"></div>
                            <div class="cc-12efcmn">
                                <div mode="none" data-testid="sticky-table-fixed"
                                     class="fixed-table-div-custom-table-resizing cc-1t3byut"
                                     style="--ak-renderer-sticky-header-zindex: 13; width: 1253.98px;">
                                    <div class="pm-table-container is-sticky with-shadow-observer" data-layout="center"
                                         style="width: inherit; margin-bottom: 0px;">
                                        <div class="pm-table-sticky-wrapper" style="overflow: hidden;">
                                            <table data-testid="renderer-table" data-number-column="false"
                                                   data-table-width="1254" data-layout="center"
                                                   style="margin-top: 0px;">
                                                <colgroup>
                                                    <col style="width: 133px;">
                                                    <col style="width: 618px;">
                                                </colgroup>
                                                <tbody>
                                                <tr>
                                                    <th rowspan="1" colspan="1" colorname=""
                                                        class="ak-renderer-tableHeader-sortable-column__wrapper"
                                                        data-colwidth="223" aria-sort="none">
                                                        <div class="ak-renderer-tableHeader-sortable-column"><p
                                                                data-renderer-start-pos="10489">Part</p>
                                                            <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                                <div role="presentation">
                                                                    <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                                         role="button" tabindex="0"
                                                                         aria-label="No sort applied to the column"
                                                                         aria-disabled="false" aria-hidden="false">
                                                                        <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                            <div class="cc-btgm1o"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </figure>
                                                        </div>
                                                    </th>
                                                    <th rowspan="1" colspan="1" colorname=""
                                                        class="ak-renderer-tableHeader-sortable-column__wrapper"
                                                        data-colwidth="1031" aria-sort="none">
                                                        <div class="ak-renderer-tableHeader-sortable-column"><p
                                                                data-renderer-start-pos="10497">Description</p>
                                                            <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                                <div role="presentation">
                                                                    <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                                         role="button" tabindex="0"
                                                                         aria-label="No sort applied to the column"
                                                                         aria-disabled="false" aria-hidden="false">
                                                                        <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                            <div class="cc-btgm1o"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </figure>
                                                        </div>
                                                    </th>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="pm-table-wrapper" data-number-column="false" data-layout="center"
                                 data-autosize="false" data-table-local-id="c12985b4-e1ec-481c-8190-ecca1967fe56"
                                 data-table-width="1254" data-vc="table-node-wrapper">
                                <div class="sentinel-left"></div>
                                <table data-testid="renderer-table" data-number-column="false" data-table-width="1254"
                                       data-layout="center">
                                    <colgroup>
                                        <col style="width: 133px;">
                                        <col style="width: 618px;">
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <th rowspan="1" colspan="1" colorname=""
                                            class="ak-renderer-tableHeader-sortable-column__wrapper" data-colwidth="223"
                                            aria-sort="none">
                                            <div class="ak-renderer-tableHeader-sortable-column"><p
                                                    data-renderer-start-pos="10489">Part</p>
                                                <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                    <div role="presentation">
                                                        <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                             role="button" tabindex="0"
                                                             aria-label="No sort applied to the column"
                                                             aria-disabled="false" aria-hidden="false">
                                                            <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                <div class="cc-btgm1o"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </figure>
                                            </div>
                                        </th>
                                        <th rowspan="1" colspan="1" colorname=""
                                            class="ak-renderer-tableHeader-sortable-column__wrapper"
                                            data-colwidth="1031" aria-sort="none">
                                            <div class="ak-renderer-tableHeader-sortable-column"><p
                                                    data-renderer-start-pos="10497">Description</p>
                                                <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                    <div role="presentation">
                                                        <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                             role="button" tabindex="0"
                                                             aria-label="No sort applied to the column"
                                                             aria-disabled="false" aria-hidden="false">
                                                            <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                <div class="cc-btgm1o"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </figure>
                                            </div>
                                        </th>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="223"><p
                                                data-renderer-start-pos="10514"><code
                                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                data-renderer-mark="true">"payment-topic"</code></p></td>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="1031"><p
                                                data-renderer-start-pos="10533">Name of the topic being created. In this
                                            case, the topic is called <code
                                                    class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                    data-renderer-mark="true">"payment-topic"</code>.</p></td>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="223"><p
                                                data-renderer-start-pos="10622"><code
                                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                data-renderer-mark="true">3</code></p></td>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="1031"><p
                                                data-renderer-start-pos="10627"><strong data-renderer-mark="true">Number
                                            of partitions</strong> for the topic. This means the topic will be split
                                            into 3 partitions. Each partition can handle part of the data for
                                            parallelism and scalability.</p></td>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="223"><p
                                                data-renderer-start-pos="10798"><code
                                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                data-renderer-mark="true">(short) 1</code></p></td>
                                        <td rowspan="1" colspan="1" colorname="" data-colwidth="1031"><p
                                                data-renderer-start-pos="10811"><strong data-renderer-mark="true">Replication
                                            factor</strong>. The number <code
                                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                data-renderer-mark="true">1</code> (cast to <code
                                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                data-renderer-mark="true">short</code>) means each partition will have 1
                                            copy (no replication). Normally in production, this is  2 for fault
                                            tolerance.</p></td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="sentinel-right"></div>
                            </div>
                            <div class="pm-table-sticky-scrollbar-container-view-page"
                                 data-vc="table-sticky-scrollbar-container"
                                 style="height: var(--ds-space-250, 20px); display: block; width: 100%; visibility: hidden; overflow-x: auto; position: sticky; bottom: var(--ds-space-0, 0px); z-index: 1;">
                                <div style="width: 100%; height: 100%;"></div>
                            </div>
                            <div class="pm-table-sticky-scrollbar-sentinel-bottom"
                                 data-testid="sticky-scrollbar-sentinel-bottom"></div>
                        </div>
                        <p data-renderer-start-pos="10977">&nbsp;</p>
                        <p data-renderer-start-pos="10979"><strong data-renderer-mark="true">ProducerService
                            Class: </strong>Autodires KafkaTemplate.</p>
                        <p data-renderer-start-pos="11028">Includes methods to generate random payment transactions.</p>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token annotation punctuation">@Service</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class=""></span><span
                                    class="token annotation punctuation">@Slf4j</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class=""></span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">class</span><span
                                    class=""> </span><span class="token class-name">ProducerService</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span>
</span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@Autowired</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span><span
                                    class=""><span class="">    </span><span class="token keyword">private</span><span
                                    class=""> </span><span class="token class-name">KafkaTemplate</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> kafkaTemplate</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span>
</span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class="">    </span><span class="token comment">//generateRandomTransaction</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">String</span><span class=""> </span><span
                                    class="token function">generateRandomTransaction</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">String</span><span class=""> vendors</span><span
                                    class="token punctuation">[</span><span class="token punctuation">]</span><span
                                    class="token operator">=</span><span class="token punctuation">{</span><span
                                    class="token string">"Amazon"</span><span class="token punctuation">,</span><span
                                    class="token string">"Paypal"</span><span class="token punctuation">,</span><span
                                    class="token string">"Visa"</span><span class="token punctuation">,</span><span
                                    class="token string">"mastercard"</span><span
                                    class="token punctuation">}</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-11" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="11"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">String</span><span class=""> vendor</span><span
                                    class="token operator">=</span><span class=""> vendors</span><span
                                    class="token punctuation">[</span><span
                                    class="token class-name">ThreadLocalRandom</span><span
                                    class="token punctuation">.</span><span class="token function">current</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">nextInt</span><span
                                    class="token punctuation">(</span><span class="">vendors</span><span
                                    class="token punctuation">.</span><span class="">length</span><span
                                    class="token punctuation">)</span><span class="token punctuation">]</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-12" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="12"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">double</span><span class=""> amount </span><span
                                    class="token operator">=</span><span class=""> </span><span
                                    class="token class-name">ThreadLocalRandom</span><span
                                    class="token punctuation">.</span><span class="token function">current</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">nextDouble</span><span
                                    class="token punctuation">(</span><span class="token number">0.10</span><span
                                    class="token punctuation">,</span><span class="token number">1000.0</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-13" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="13"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token string">"Vendor: "</span><span class="token operator">+</span><span
                                    class="">vendor</span><span class="token operator">+</span><span
                                    class="token string">"Amount $"</span><span class="token operator">+</span><span
                                    class="">amount</span><span class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-14" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="14"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-15" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="15"></span>
</span><span data-testid="renderer-code-block-line-16" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="16"></span><span
                                    class=""><span class="">    </span><span class="token comment">//SendPaymentTransactions Asynchronously</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-17" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="17"></span><span
                                    class=""><span class="">   </span><span class="token comment">// @Scheduled(fixedRate = 2000)</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-18" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="18"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token class-name">SendPaymentTransactionsAsynchronously</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-19" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="19"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">String</span><span class=""> transaction</span><span
                                    class="token operator">=</span><span class=""> </span><span class="token function">generateRandomTransaction</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-20" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="20"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Sending payment transactions {}"</span><span
                                    class="token punctuation">,</span><span class="">transaction</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-21" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="21"></span><span
                                    class=""><span class="">        kafkaTemplate</span><span class="token punctuation">.</span><span
                                    class="token function">send</span><span class="token punctuation">(</span><span
                                    class="token string">"payment-topic"</span><span
                                    class="token punctuation">,</span><span class="">transaction</span><span
                                    class="token punctuation">)</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-22" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="22"></span><span
                                    class=""><span class="">                </span><span
                                    class="token punctuation">.</span><span
                                    class="token function">whenComplete</span><span
                                    class="token punctuation">(</span><span class="token punctuation">(</span><span
                                    class="token punctuation">(</span><span class="">sendResult</span><span
                                    class="token punctuation">,</span><span class=""> throwable</span><span
                                    class="token punctuation">)</span><span class=""> </span><span
                                    class="token operator">-&gt;</span><span class=""> </span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-23" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="23"></span><span
                                    class=""><span class="">                    </span><span
                                    class="token keyword">if</span><span class="token punctuation">(</span><span
                                    class="">throwable</span><span class="token operator">!=</span><span
                                    class="token keyword">null</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-24" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="24"></span><span
                                    class=""><span class="">                        </span><span class="token function">onFailure</span><span
                                    class="token punctuation">(</span><span class="">throwable</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-25" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="25"></span><span
                                    class=""><span class="">                    </span><span
                                    class="token punctuation">}</span><span class="token keyword">else</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-26" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="26"></span><span
                                    class=""><span class="">                        </span><span class="token function">onSuccess</span><span
                                    class="token punctuation">(</span><span class="">sendResult</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-27" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="27"></span><span
                                    class=""><span class="">                    </span><span
                                    class="token punctuation">}</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-28" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="28"></span><span
                                    class=""><span class="">                </span><span
                                    class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-29" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="29"></span>
</span><span data-testid="renderer-code-block-line-30" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="30"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-31" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="31"></span>
</span><span data-testid="renderer-code-block-line-32" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="32"></span><span
                                    class=""><span class="">    </span><span class="token keyword">private</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token function">onSuccess</span><span class="token punctuation">(</span><span
                                    class="token class-name">SendResult</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> sendResult</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-33" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="33"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Received new metadata. \n"</span><span
                                    class=""> </span><span class="token operator">+</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-34" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="34"></span><span
                                    class=""><span class="">                        </span><span class="token string">"Topic: {}, Partition: {}, Offset: {}, Timestamp: {}"</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-35" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="35"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">topic</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-36" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="36"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">partition</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-37" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="37"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">offset</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-38" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="38"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">timestamp</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-39" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="39"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-40" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="40"></span>
</span><span data-testid="renderer-code-block-line-41" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="41"></span><span
                                    class=""><span class="">    </span><span class="token keyword">private</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token function">onFailure</span><span class="token punctuation">(</span><span
                                    class="token class-name">Throwable</span><span class=""> throwable</span><span
                                    class="token punctuation">)</span><span class=""> </span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-42" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="42"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Error occurred while producing the message {}"</span><span
                                    class="token punctuation">,</span><span class=""> throwable</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-43" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="43"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-44" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="44"></span>
</span><span data-testid="renderer-code-block-line-45" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="45"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">String</span><span class=""> </span><span
                                    class="token function">generateTransactionKey</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">{</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-46" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="46"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> UUID</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">randomUUID</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">toString</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-47" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="47"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-48" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="48"></span>
</span><span data-testid="renderer-code-block-line-49" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="49"></span>
</span><span data-testid="renderer-code-block-line-50" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="50"></span><span
                                    class=""><span class="">    </span><span class="token comment">//SendPaymentTransactions-2)synchronously</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-51" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="51"></span>
</span><span data-testid="renderer-code-block-line-52" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="52"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@Scheduled</span><span
                                    class="token punctuation">(</span><span class="">fixedRate </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token number">2000</span><span
                                    class="token punctuation">)</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-53" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="53"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">SendResult</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token class-name">SendPaymentTransactionsSynchronously</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token keyword">throws</span><span
                                    class=""> </span><span class="token class-name">ExecutionException</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">InterruptedException</span><span class=""> </span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-54" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="54"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">String</span><span class=""> transaction</span><span
                                    class="token operator">=</span><span class=""> </span><span class="token function">generateRandomTransaction</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-55" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="55"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Sending payment transactions {}"</span><span
                                    class="token punctuation">,</span><span class="">transaction</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-56" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="56"></span><span
                                    class=""><span class="">       </span><span
                                    class="token class-name">SendResult</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> sendResult </span><span class="token operator">=</span><span class=""> kafkaTemplate</span><span
                                    class="token punctuation">.</span><span class="token function">send</span><span
                                    class="token punctuation">(</span><span
                                    class="token string">"payment-topic"</span><span
                                    class="token punctuation">,</span><span class="token function">generateTransactionKey</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">transaction</span><span
                                    class="token punctuation">)</span><span class="token punctuation">.</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-57" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="57"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Received new metadata. \n"</span><span
                                    class=""> </span><span class="token operator">+</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-58" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="58"></span><span
                                    class=""><span class="">                        </span><span class="token string">"Topic: {}, Partition: {}, Offset: {}, Timestamp: {}"</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-59" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="59"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">topic</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-60" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="60"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">partition</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-61" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="61"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">offset</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-62" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="62"></span><span
                                    class=""><span class="">                sendResult</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">getRecordMetadata</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">.</span><span class="token function">timestamp</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-63" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="63"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> sendResult</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-64" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="64"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-65" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="65"></span><span
                                    class=""><span class=""></span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <p data-renderer-start-pos="13678"><strong data-renderer-mark="true">Sending
                            Messages:Asynchronously:</strong> kafkaTemplate.send(topic, key, value) returns a
                            ListenableFuture. A whenComplete callback is used to process the SendResult (containing
                            metadata like topic, partition, offset, timestamp) on success or handle exceptions on
                            failure.</p>
                        <p data-renderer-start-pos="13943"><strong data-renderer-mark="true">Synchronously:</strong>
                            <strong data-renderer-mark="true">kafkaTemplate.send(topic, key, value).get()</strong>
                            blocks until the message is sent and returns the SendResult.</p>
                        <p data-renderer-start-pos="14064"><strong data-renderer-mark="true">Scheduling:</strong> Uses
                            @Scheduled(fixedRate = 2000) to send transactions every 2 seconds.</p>
                        <p data-renderer-start-pos="14149">&nbsp;</p>
                        <p data-renderer-start-pos="14151"><strong data-renderer-mark="true">Specific Partition
                            Sending:</strong> kafkaTemplate.send(topic, partition, key, value) allows explicitly
                            specifying the target partition.</p>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(1ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class="">// Case 1: Send to specific partition, here 2
</span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span>kafkaTemplate.send("payment-topic", 2, "txn123", "Rs 100 paid");
</span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span>
</span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span>// Case 2: Send with key (Kafka decides partition using key hash)
</span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span>kafkaTemplate.send("payment-topic", "txn123", "Rs 200 paid");
</span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span>
</span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span>// Case 3: Send without key (Kafka round-robins the partition)
</span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span>kafkaTemplate.send("payment-topic", "Rs 300 paid");
</span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number"
                                    data-ds--line-number="9"></span></span></code></span></div>
                        <p data-renderer-start-pos="14638">&nbsp;</p>
                        <h4 id="6.3-Consumer-Configuration-and-Service" data-renderer-start-pos="14640"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">6.3 Consumer Configuration and Service</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h4>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="14680"><strong data-renderer-mark="true">Dependencies:</strong>
                            Similar to producer, Spring Web and Kafka are needed.</p>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="xml" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(1ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-xml" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token tag token tag token punctuation">&lt;</span><span
                                    class="token tag token tag">dependency</span><span
                                    class="token tag token punctuation">&gt;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class="">	</span><span
                                    class="token tag token tag token punctuation">&lt;</span><span
                                    class="token tag token tag">groupId</span><span class="token tag token punctuation">&gt;</span><span
                                    class="">org.springframework.kafka</span><span
                                    class="token tag token tag token punctuation">&lt;/</span><span
                                    class="token tag token tag">groupId</span><span class="token tag token punctuation">&gt;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class="">	</span><span
                                    class="token tag token tag token punctuation">&lt;</span><span
                                    class="token tag token tag">artifactId</span><span
                                    class="token tag token punctuation">&gt;</span><span
                                    class="">spring-kafka</span><span class="token tag token tag token punctuation">&lt;/</span><span
                                    class="token tag token tag">artifactId</span><span
                                    class="token tag token punctuation">&gt;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span><span
                                    class=""><span class=""></span><span class="token tag token tag token punctuation">&lt;/</span><span
                                    class="token tag token tag">dependency</span><span
                                    class="token tag token punctuation">&gt;</span></span></span></code></span></div>
                        <p data-renderer-start-pos="14862"><strong data-renderer-mark="true">ConsumerConfiguration
                            Class:</strong>Defines two beans:</p>
                        <ol class="ak-ol" data-indent-level="1" start="1">
                            <li><p data-renderer-start-pos="14912"><strong
                                    data-renderer-mark="true">ConsumerFactory:</strong> Configured with
                                bootstrap.servers, key.deserializer, and value.deserializer.</p></li>
                            <li><p data-renderer-start-pos="15009"><strong data-renderer-mark="true">ConcurrentKafkaListenerContainerFactory:</strong>
                                Used to create KafkaMessageListenerContainer instances that manage Kafka consumers. It's
                                configured with the ConsumerFactory.</p></li>
                        </ol>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token annotation punctuation">@Configuration</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class=""></span><span class="token annotation punctuation">@EnableKafka</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class=""></span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">class</span><span
                                    class=""> </span><span class="token class-name">ConsumerConfiguration</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span>
</span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">    </span><span
                                    class="token comment">//ConsumerFactory</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span>
</span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span><span
                                    class=""><span class="">    </span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">ConsumerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">consumerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">Map</span><span class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">Object</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> configMap </span><span class="token operator">=</span><span
                                    class=""> </span><span class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">HashMap</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class="">        configMap</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ConsumerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">BOOTSTRAP_SERVERS_CONFIG</span><span
                                    class="token punctuation">,</span><span class="token string">"localhost:9092"</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-11" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="11"></span><span
                                    class=""><span class="">        configMap</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ConsumerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">KEY_DESERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">StringDeserializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-12" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="12"></span><span
                                    class=""><span class="">        configMap</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ConsumerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">VALUE_DESERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">StringDeserializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-13" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="13"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">DefaultKafkaConsumerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="">configMap</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-14" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="14"></span>
</span><span data-testid="renderer-code-block-line-15" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="15"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-16" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="16"></span><span
                                    class=""><span class="">    </span><span class="token comment">//ConcurrentKafkaListenerContainerFactory</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-17" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="17"></span><span
                                    class=""><span class="">    </span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-18" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="18"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">ConcurrentKafkaListenerContainerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">concurrentKafkaListenerContainerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-19" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="19"></span>
</span><span data-testid="renderer-code-block-line-20" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="20"></span><span
                                    class=""><span class="">        </span><span class="token class-name">ConcurrentKafkaListenerContainerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> containerFactory </span><span class="token operator">=</span><span
                                    class=""> </span><span class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">ConcurrentKafkaListenerContainerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-21" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="21"></span><span
                                    class=""><span class="">        containerFactory</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">setConsumerFactory</span><span
                                    class="token punctuation">(</span><span
                                    class="token function">consumerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-22" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="22"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> containerFactory</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-23" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="23"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-24" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="24"></span>
</span><span data-testid="renderer-code-block-line-25" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="25"></span><span
                                    class=""><span class=""></span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <p data-renderer-start-pos="16154">&nbsp;</p>
                        <p data-renderer-start-pos="16156"><strong data-renderer-mark="true">ConsumerService
                            Class:</strong>Uses <strong data-renderer-mark="true">@KafkaListener</strong> annotation to
                            listen for messages:</p>
                        <p data-renderer-start-pos="16234">@KafkaListener(topics = "payment-topic", groupId =
                            "group-id"): Basic listener for a topic within a consumer group.</p>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token annotation punctuation">@Service</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class=""></span><span
                                    class="token annotation punctuation">@Slf4j</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class=""></span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">class</span><span
                                    class=""> </span><span class="token class-name">ConsumerService</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span>
</span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@Autowired</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span><span
                                    class=""><span class="">    </span><span class="token keyword">private</span><span
                                    class=""> </span><span class="token class-name">KafkaTemplate</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> kafkaTemplate</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span>
</span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@KafkaListener</span><span
                                    class="token punctuation">(</span><span class="">topics </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"payment-topic"</span><span
                                    class="token punctuation">,</span><span class=""> groupId </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"group_id"</span><span
                                    class="token punctuation">)</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token function">consume</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerRecord</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> message</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class="">            log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span
                                    class="token string">"Key: {} | Value: {}"</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">key</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">value</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-11" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="11"></span><span
                                    class=""><span class="">            log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Partition: {} | Offset: {}"</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">partition</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">offset</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-12" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="12"></span><span
                                    class=""><span class="">            </span><span
                                    class="token class-name">Integer</span><span class="token punctuation">.</span><span
                                    class="token function">parseInt</span><span class="token punctuation">(</span><span
                                    class="">message</span><span class="token punctuation">.</span><span
                                    class="token function">value</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-13" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="13"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-14" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="14"></span><span
                                    class=""><span class=""></span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <p data-renderer-start-pos="16827"><strong data-renderer-mark="true">Accessing Message
                            Details:</strong> The listener method can accept ConsumerRecord&lt;String, String&gt; to
                            access key, value, partition, and offset.</p>
                        <p data-renderer-start-pos="16962">&nbsp;</p>
                        <p data-renderer-start-pos="16964"><strong data-renderer-mark="true">Listening from Specific
                            Partitions:</strong> @TopicPartition annotation within @KafkaListener allows specifying
                            topic and a list of partitions to listen from (e.g., partitions = {"0", "1"}).</p>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token annotation punctuation">@KafkaListener</span><span
                                    class="token punctuation">(</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class="">    topicPartitions </span><span
                                    class="token operator">=</span><span class=""> </span><span
                                    class="token annotation punctuation">@TopicPartition</span><span
                                    class="token punctuation">(</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class="">        topic </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"payment-topic"</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span><span
                                    class=""><span class="">          partitions </span><span
                                    class="token operator">=</span><span class=""> </span><span
                                    class="token punctuation">{</span><span class=""> </span><span class="token string">"0"</span><span
                                    class="token punctuation">,</span><span class=""> </span><span class="token string">"1"</span><span
                                    class=""> </span><span class="token punctuation">}</span><span
                                    class="">  </span><span
                                    class="token comment">// consume only from partition 0 and 1</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span><span
                                    class=""><span class="">    groupId </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"manual-partition-group"</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span><span
                                    class=""><span class=""></span><span class="token punctuation">)</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class=""></span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token function">listenFromSpecificPartitions</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ConsumerRecord</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token keyword">record</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">    </span><span class="token class-name">System</span><span
                                    class="token punctuation">.</span><span class="">out</span><span
                                    class="token punctuation">.</span><span class="token function">printf</span><span
                                    class="token punctuation">(</span><span class="token string">"Consumed from partition %d: %s%n"</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token keyword">record</span><span class="token punctuation">.</span><span
                                    class="token function">partition</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">,</span><span
                                    class=""> </span><span class="token keyword">record</span><span
                                    class="token punctuation">.</span><span class="token function">value</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class=""></span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <p data-renderer-start-pos="17539">&nbsp;</p>
                        <p data-renderer-start-pos="17541"><strong data-renderer-mark="true"><span
                                data-renderer-mark="true" data-background-custom-color="#fdd0ec"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-magenta-subtler, #FDD0EC);">Concurrency</span>:</strong>
                            The concurrency property in @KafkaListener allows starting multiple consumer instances
                            (containers) for parallel message consumption (e.g., concurrency = "3").</p>
                        <p data-renderer-start-pos="17715">In <strong data-renderer-mark="true">Spring Kafka</strong>,
                            <code class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                  data-renderer-mark="true">concurrency</code> defines the number of <strong
                                    data-renderer-mark="true">consumer threads</strong> (i.e., how many instances of
                            your <code
                                    class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                    data-renderer-mark="true">@KafkaListener</code> will run in parallel) <strong
                                    data-renderer-mark="true">within the same application</strong>.</p>
                        <blockquote><p data-renderer-start-pos="17885"> This only works when the topic has <strong
                                data-renderer-mark="true">multiple partitions</strong>.</p>
                            <p data-renderer-start-pos="17945">Topic: <code
                                    class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                    data-renderer-mark="true">payment-topic</code><br>Partitions: <code
                                    class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                    data-renderer-mark="true">6</code><br>Concurrency: <code
                                    class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                    data-renderer-mark="true">3</code></p>
                            <p data-renderer-start-pos="17996"> Spring Kafka will start 3 threads:</p>
                            <ul class="ak-ul" data-indent-level="1">
                                <li><p data-renderer-start-pos="18037">Thread 1  Partition 0, 1</p></li>
                                <li><p data-renderer-start-pos="18066">Thread 2  Partition 2, 3</p></li>
                                <li><p data-renderer-start-pos="18095">Thread 3  Partition 4, 5</p></li>
                            </ul>
                            <p data-renderer-start-pos="18124">All listeners use the <strong data-renderer-mark="true">same
                                group ID</strong>, hence each thread handles <strong data-renderer-mark="true">exclusive
                                partitions</strong>.</p></blockquote>
                        <p data-renderer-start-pos="18211">&nbsp;</p>
                        <h4 id="6.4-Producing-and-Consuming-Custom-Messages" data-renderer-start-pos="18213"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">6.4 Producing and Consuming Custom Messages</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h4>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="18258"><strong data-renderer-mark="true">Custom Object
                            Serialization/Deserialization:</strong>For custom object types (e.g., Location with id,
                            locationName, and MessageMetadata), JsonSerializer (for producer value.serializer) and
                            JsonDeserializer (for consumer value.deserializer) are used.</p>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token comment">//Producer</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class=""></span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">ProducerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span class="token generics token class-name">Location</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">locationProducerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">{</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">Map</span><span class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span
                                    class="token generics token class-name">Object</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> configProps </span><span class="token operator">=</span><span
                                    class=""> </span><span class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">HashMap</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span><span
                                    class=""><span class="">        configProps</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ProducerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">BOOTSTRAP_SERVERS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span class="token string">"localhost:9092"</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span><span
                                    class=""><span class="">        configProps</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ProducerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">KEY_SERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">StringSerializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class="">        configProps</span><span
                                    class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">ProducerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">VALUE_SERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">JsonSerializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">DefaultKafkaProducerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="">configProps</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-11" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="11"></span>
</span><span data-testid="renderer-code-block-line-12" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="12"></span><span
                                    class=""><span class="">    </span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-13" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="13"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">KafkaTemplate</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span class="token generics token class-name">Location</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">locationKafkaTemplate</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-14" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="14"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">{</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-15" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="15"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">KafkaTemplate</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token function">locationProducerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-16" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="16"></span><span
                                    class=""><span class="">    </span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token comment">//Consumer</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class=""></span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">ConsumerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span class="token generics token class-name">Location</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">locationConsumerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span><span
                                    class=""><span class="">        </span><span
                                    class="token class-name">Map</span><span class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span
                                    class="token generics token class-name">Object</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> props </span><span class="token operator">=</span><span
                                    class=""> </span><span class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">HashMap</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">        props</span><span class="token punctuation">.</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">BOOTSTRAP_SERVERS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span class="token string">"localhost:9092"</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span><span
                                    class=""><span class="">        props</span><span class="token punctuation">.</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerConfig</span><span
                                    class="token punctuation">.</span><span class="">GROUP_ID_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span class="token string">"location-group-id"</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span><span
                                    class=""><span class="">        props</span><span class="token punctuation">.</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">KEY_DESERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">StringDeserializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class="">        props</span><span class="token punctuation">.</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerConfig</span><span
                                    class="token punctuation">.</span><span
                                    class="">VALUE_DESERIALIZER_CLASS_CONFIG</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token class-name">JsonDeserializer</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">DefaultKafkaConsumerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="">props</span><span class="token punctuation">,</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">StringDeserializer</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> </span><span
                                    class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">JsonDeserializer</span><span
                                    class="token punctuation">(</span><span
                                    class="token class-name">Location</span><span
                                    class="token punctuation">.</span><span class="token keyword">class</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-11" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="11"></span>
</span><span data-testid="renderer-code-block-line-12" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="12"></span><span
                                    class=""><span class="">    </span><span
                                    class="token annotation punctuation">@Bean</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-13" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="13"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token class-name">ConcurrentKafkaListenerContainerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span class="token generics token class-name">Location</span><span
                                    class="token generics token punctuation">&gt;</span><span class=""> </span><span
                                    class="token function">locationListener</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-14" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="14"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">{</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-15" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="15"></span><span
                                    class=""><span class="">        </span><span class="token class-name">ConcurrentKafkaListenerContainerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics"> </span><span class="token generics token class-name">Location</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> factory </span><span class="token operator">=</span><span
                                    class=""> </span><span class="token keyword">new</span><span class=""> </span><span
                                    class="token class-name">ConcurrentKafkaListenerContainerFactory</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token punctuation">&gt;</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-16" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="16"></span><span
                                    class=""><span class="">        factory</span><span
                                    class="token punctuation">.</span><span
                                    class="token function">setConsumerFactory</span><span
                                    class="token punctuation">(</span><span class="token function">locationConsumerFactory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-17" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="17"></span><span
                                    class=""><span class="">        </span><span
                                    class="token keyword">return</span><span class=""> factory</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-18" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="18"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-19" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="19"></span>
</span><span data-testid="renderer-code-block-line-20" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="20"></span><span
                                    class=""><span class=""> </span><span class="token annotation punctuation">@KafkaListener</span><span
                                    class="token punctuation">(</span><span class="">topics </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"location-topic"</span><span
                                    class="token punctuation">,</span><span class=""> groupId </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"location-group-id"</span><span
                                    class="token punctuation">,</span><span class=""> concurrency </span><span
                                    class="token operator">=</span><span class=""> </span><span
                                    class="token string">"3"</span><span class="token punctuation">)</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-21" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="21"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token function">listen</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerRecord</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">Location</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> message</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-22" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="22"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span
                                    class="token string">"Key: {} | Value: {}"</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">key</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">value</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-23" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="23"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Partition: {} | Offset: {}"</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">partition</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">offset</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-24" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="24"></span><span
                                    class=""><span class="">    </span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <p data-renderer-start-pos="20398">The MessageMetadata can include details like messageId,
                            sourceOriginator, and timestamp to track message origin and context.</p>
                        <p data-renderer-start-pos="20524"><strong data-renderer-mark="true">Consumer Group ID:</strong>
                            For custom message consumption, ensure a unique group.id is defined for each consumer group
                            to correctly identify and coordinate consumers.</p>
                        <p data-renderer-start-pos="20684">&nbsp;</p>
                        <h4 id="6.5-Consumer-Partition-Rebalance" data-renderer-start-pos="20686"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">6.5 Consumer Partition Rebalance</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h4>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="20720">When a new consumer joins a consumer group (with the same
                            group.id), the GroupCoordinator triggers a <strong
                                    data-renderer-mark="true">rebalance</strong>.</p>
                        <p data-renderer-start-pos="20833"><strong data-renderer-mark="true">Rebalancing</strong>
                            involves changing partition ownership from one consumer to another to distribute the
                            workload evenly among active consumers in the group. This ensures efficient parallel
                            processing as consumers are assigned specific partitions.</p>
                        <p data-renderer-start-pos="21074">&nbsp;</p>
                        <h4 id="6.6-Committing-Offsets" data-renderer-start-pos="21076"><span data-renderer-mark="true"
                                                                                              data-background-custom-color="#c6edfb"
                                                                                              class="fabric-background-color-mark"
                                                                                              style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">6.6 Committing Offsets</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h4>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <ul class="ak-ul" data-indent-level="1">
                            <li><p data-renderer-start-pos="21102"><strong data-renderer-mark="true">Offset
                                Committing:</strong> When a consumer consumes messages, it needs to send an
                                acknowledgement to the broker (or Kafka itself in newer versions) by committing its
                                offset. This tracks the consumer's progress.</p></li>
                            <li><p data-renderer-start-pos="21308"><strong data-renderer-mark="true">enable.auto.commit
                                Property:</strong>If true, Kafka automatically commits offsets based on its internal
                                configuration.</p></li>
                            <li><p data-renderer-start-pos="21421">If false (default since Spring for Apache Kafka
                                2.2.3), the container supports several acknowledgement modes.</p></li>
                            <li><p data-renderer-start-pos="21534"><strong data-renderer-mark="true">Acknowledgement
                                Modes (ackMode):BATCH (Default):</strong> "Commit the offset when all records written by
                                the poll that have been processed." This means offsets are committed after a batch of
                                messages has been successfully processed.</p></li>
                            <li><p data-renderer-start-pos="21761"><strong data-renderer-mark="true">RECORD:</strong>
                                "Commit the offset when The Listener returns after processing the Record here." Offsets
                                are committed immediately after each individual record is processed.</p></li>
                            <li><p data-renderer-start-pos="21929">Other options include <strong
                                    data-renderer-mark="true">TIME, COUNT, MANUAL, MANUAL_IMMEDIATE</strong>. The choice
                                depends on the application's reliability and performance requirements.</p></li>
                        </ul>
                        <p data-renderer-start-pos="22075">&nbsp;</p>
                        <h4 id="6.7-Error-Handling-in-Kafka-Consumers" data-renderer-start-pos="22077"><span
                                data-renderer-mark="true" data-background-custom-color="#c6edfb"
                                class="fabric-background-color-mark"
                                style="--custom-palette-color: var(--ds-background-accent-teal-subtler, #C6EDFB);">6.7 Error Handling in Kafka Consumers</span><span
                                role="presentation" class="heading-anchor-wrapper"></span></h4>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="22116">Spring for Apache Kafka provides robust error handling
                            mechanisms:</p>
                        <ul class="ak-ul" data-indent-level="1">
                            <li><p data-renderer-start-pos="22186"><strong data-renderer-mark="true">Blocking
                                Retry: </strong>If a retryable exception occurs during message consumption, the consumer
                                will retry processing the message.</p></li>
                            <li><p data-renderer-start-pos="22313">This approach <strong data-renderer-mark="true">blocks</strong>
                                the consumption of subsequent messages until the current message is successfully
                                processed or the retry attempts are exhausted.</p></li>
                            <li><p data-renderer-start-pos="22465">Default behavior: attempts to consume a message at
                                least 10 times before moving to the next message and logging an error.</p></li>
                            <li><p data-renderer-start-pos="22590"><strong data-renderer-mark="true">Non-Blocking Retry
                                (@RetryableTopic):</strong>Uses @RetryableTopic annotation on the @KafkaListener method.
                            </p></li>
                            <li><p data-renderer-start-pos="22692">When a message fails, it's sent to a dedicated
                                <strong data-renderer-mark="true">retry topic</strong> (e.g., payment-topic-retry-3000).
                            </p></li>
                            <li><p data-renderer-start-pos="22788">Configurable with attempts (number of retries) and
                                backoff (delay between retries, with optional multiplier).</p></li>
                            <li><p data-renderer-start-pos="22901">This prevents blocking the main consumer thread,
                                allowing other messages to be processed while a failing message is retried on a separate
                                topic.</p></li>
                            <li><p data-renderer-start-pos="23049"><strong data-renderer-mark="true">Dead Letter Topic
                                and Handler (@DltHandler):</strong>When messages exceed the maximum non-blocking retry
                                attempts, they are automatically sent to a <strong data-renderer-mark="true">dead letter
                                    topic</strong> (DLT).</p></li>
                            <li><p data-renderer-start-pos="23216">A separate @DltHandler method is used to process
                                these failed messages (e.g., for logging, alerting via email notifications, or further
                                manual intervention).</p></li>
                            <li><p data-renderer-start-pos="23377">This ensures that messages that cannot be processed
                                after multiple retries are not lost but are moved to a designated location for analysis
                                and resolution.</p></li>
                        </ul>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="java" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(2ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-java" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class=""><span class="token annotation punctuation">@Service</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span><span
                                    class=""><span class=""></span><span
                                    class="token annotation punctuation">@Slf4j</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span><span
                                    class=""><span class=""></span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">class</span><span
                                    class=""> </span><span class="token class-name">ConsumerService</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span>
</span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@Autowired</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span><span
                                    class=""><span class="">    </span><span class="token keyword">private</span><span
                                    class=""> </span><span class="token class-name">KafkaTemplate</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> kafkaTemplate</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-7" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="7"></span>
</span><span data-testid="renderer-code-block-line-8" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="8"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@RetryableTopic</span><span
                                    class="token punctuation">(</span><span class="">attempts </span><span
                                    class="token operator">=</span><span class=""> </span><span
                                    class="token string">"3"</span><span class="token punctuation">,</span><span
                                    class=""> backoff </span><span class="token operator">=</span><span
                                    class=""> </span><span class="token annotation punctuation">@Backoff</span><span
                                    class="token punctuation">(</span><span class="">delay </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token number">3000</span><span
                                    class="token punctuation">,</span><span class=""> multiplier </span><span
                                    class="token operator">=</span><span class="token number">2</span><span
                                    class=""> </span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-9" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="9"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@KafkaListener</span><span
                                    class="token punctuation">(</span><span class="">topics </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"payment-topic"</span><span
                                    class="token punctuation">,</span><span class=""> groupId </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"group_id"</span><span
                                    class="token punctuation">,</span><span class=""> containerFactory </span><span
                                    class="token operator">=</span><span class=""> </span><span class="token string">"concurrentKafkaListenerContainerFactory"</span><span
                                    class="token punctuation">)</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-10" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="10"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token function">consume</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerRecord</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> message</span><span class="token punctuation">)</span><span
                                    class=""> </span><span class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-11" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="11"></span><span
                                    class=""><span class="">            log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span
                                    class="token string">"Key: {} | Value: {}"</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">key</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">value</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-12" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="12"></span><span
                                    class=""><span class="">            log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Partition: {} | Offset: {}"</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">partition</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">offset</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-13" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="13"></span><span
                                    class=""><span class="">            </span><span
                                    class="token class-name">Integer</span><span class="token punctuation">.</span><span
                                    class="token function">parseInt</span><span class="token punctuation">(</span><span
                                    class="">message</span><span class="token punctuation">.</span><span
                                    class="token function">value</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-14" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="14"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-15" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="15"></span>
</span><span data-testid="renderer-code-block-line-16" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="16"></span><span
                                    class=""><span class="">    </span><span class="token annotation punctuation">@DltHandler</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-17" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="17"></span><span
                                    class=""><span class="">    </span><span class="token keyword">public</span><span
                                    class=""> </span><span class="token keyword">void</span><span class=""> </span><span
                                    class="token function">processFailureMessages</span><span class="token punctuation">(</span><span
                                    class="token class-name">ConsumerRecord</span><span
                                    class="token generics token punctuation">&lt;</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">,</span><span
                                    class="token generics token class-name">String</span><span
                                    class="token generics token punctuation">&gt;</span><span
                                    class=""> message</span><span class="token punctuation">)</span><span
                                    class="token punctuation">{</span><span class="">
</span></span></span><span data-testid="renderer-code-block-line-18" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="18"></span><span
                                    class=""><span class="">        log</span><span
                                    class="token punctuation">.</span><span class="token function">info</span><span
                                    class="token punctuation">(</span><span class="token string">"Dead letter topic Key: {} | Value: {}"</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">key</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span><span class=""> message</span><span
                                    class="token punctuation">.</span><span class="token function">value</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-19" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="19"></span>
</span><span data-testid="renderer-code-block-line-20" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="20"></span><span
                                    class=""><span class="">        </span><span class="token comment">//Send email notifications about failure message</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-21" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="21"></span>
</span><span data-testid="renderer-code-block-line-22" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="22"></span><span
                                    class=""><span class="">    </span><span class="token punctuation">}</span><span
                                    class="">
</span></span></span><span data-testid="renderer-code-block-line-23" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="23"></span><span
                                    class=""><span class=""></span><span
                                    class="token punctuation">}</span></span></span></code></span></div>
                        <div class="pm-table-container with-shadow-observer" data-layout="custom"
                             data-testid="table-container" style="width: min(1236px, 100cqw);">
                            <div class="pm-table-sticky-scrollbar-sentinel-top"
                                 data-testid="sticky-scrollbar-sentinel-top"></div>
                            <div class="pm-table-wrapper" data-number-column="false" data-layout="center"
                                 data-autosize="false" data-table-local-id="c8455f6a-4f46-4546-a4c2-0a74460ea4ca"
                                 data-table-width="1236" data-vc="table-node-wrapper">
                                <div class="sentinel-left"></div>
                                <table data-testid="renderer-table" data-number-column="false" data-table-width="1236"
                                       data-layout="center">
                                    <colgroup>
                                        <col style="width: 370px;">
                                        <col style="width: 370px;">
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <th rowspan="1" colspan="1" colorname=""
                                            class="ak-renderer-tableHeader-sortable-column__wrapper" aria-sort="none">
                                            <div class="ak-renderer-tableHeader-sortable-column"><p
                                                    data-renderer-start-pos="24415">Attribute</p>
                                                <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                    <div role="presentation">
                                                        <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                             role="button" tabindex="0"
                                                             aria-label="No sort applied to the column"
                                                             aria-disabled="false" aria-hidden="false">
                                                            <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                <div class="cc-btgm1o"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </figure>
                                            </div>
                                        </th>
                                        <th rowspan="1" colspan="1" colorname=""
                                            class="ak-renderer-tableHeader-sortable-column__wrapper" aria-sort="none">
                                            <div class="ak-renderer-tableHeader-sortable-column"><p
                                                    data-renderer-start-pos="24428">Meaning</p>
                                                <figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order">
                                                    <div role="presentation">
                                                        <div class="ak-renderer-tableHeader-sorting-icon  cc-xy3osd"
                                                             role="button" tabindex="0"
                                                             aria-label="No sort applied to the column"
                                                             aria-disabled="false" aria-hidden="false">
                                                            <div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive cc-37vp66">
                                                                <div class="cc-btgm1o"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </figure>
                                            </div>
                                        </th>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname=""><p data-renderer-start-pos="24441">
                                            <code class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                  data-renderer-mark="true">attempts = "3"</code></p></td>
                                        <td rowspan="1" colspan="1" colorname=""><p data-renderer-start-pos="24459">
                                            Total of <strong data-renderer-mark="true">3 delivery attempts</strong> (1
                                            original + 2 retries).</p></td>
                                    </tr>
                                    <tr>
                                        <td rowspan="1" colspan="1" colorname=""><p data-renderer-start-pos="24519">
                                            <code class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                                  data-renderer-mark="true">@Backoff(delay = 3000, multiplier =
                                                2)</code></p></td>
                                        <td rowspan="1" colspan="1" colorname=""><p data-renderer-start-pos="24561">Wait
                                            <strong data-renderer-mark="true">3 seconds</strong> before first retry,
                                            then backoff doubles: 3s  6s.</p></td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="sentinel-right"></div>
                            </div>
                            <div class="pm-table-sticky-scrollbar-container-view-page"
                                 data-vc="table-sticky-scrollbar-container"
                                 style="height: var(--ds-space-250, 20px); display: block; width: 100%; visibility: hidden; overflow-x: auto; position: sticky; bottom: var(--ds-space-0, 0px); z-index: 1;">
                                <div style="width: 100%; height: 100%;"></div>
                            </div>
                            <div class="pm-table-sticky-scrollbar-sentinel-bottom"
                                 data-testid="sticky-scrollbar-sentinel-bottom"></div>
                        </div>
                        <div class="code-block  cc-1lw6ekp">
                            <span data-code-lang="xml" data-ds--code--code-block=""
                                  class="prismjs _2rkoglpi _1dqoglyw _1wyb1crf _k48pi7a9 _1e0c1txw _vwz4gktf _1reo1wug _o572qvpr _1eimjvyg _bfhktkvp _syaz1fxt _ect41odn _1ozdn7od _7xinn7od _t7aun7od _1v15u2gc _ilvcu2gc _m29uu2gc _17wyu2gc _pn28u2gc _gz9fu2gc _1hmyegat _vblregat _vbulegat _wozj1yev _1agb1yev _lkm81yev _tv41hkgb _1hmimyb0 _1ra01n1a _1d4j1y44 _1f8gstnw _1pzyb3bt _j1w0ww7y _13cdh2mm _15ba126e _zvy9f705 _qcxof705 _14y71a66 _j0l11wug _1weckb7n _1na21hna _1xx2grf3 _x7c815vq _lh0y15vq _1m3815vq _qk1e15vq _12l6ysn8 _uga3ysn8 _mx8b7mnp _1kr87mnp _xo19t94y _1bemt94y _nalpstnw _151dstnw _1exb1q9c _1hgu1q9c _1mgnt94y _nhket94y _h909m7j4 _scgayz1z _ipl81e17 _jeky1l04 _1gec1a66 _1gx21e5h _1ls01ule _vm2c1rh5 _12ok1rh5 _rude1ule _1q16glyw _1io6glyw _juomusic _lcwuusic _1552u2gc _12afu2gc _28ddu2gc _1i8zu2gc _12tu1a66 _zu0j1a66 _euyxusvi _cahfusvi _zhnuidpf _1amdidpf _mbgcpf9b _bu7zpf9b _131n1giz _gy101giz _1wfuwrk5 _16kzwrk5 _9kk3moej _cjus1w1g _9k2r1m30 _nhmw1m30 _yl021m30 _eiht5x2v _t9zb5x2v _mqok1w1g _3hsg1w1g _i7ngn7od _9wu1fb2s _1xcoh55r _1t361fxt _137bh55r _1k7d1fxt _97lipnps _12nh9lu1 _1g0517qg _i2ig10m5 _326z1fxt _113p131l _1n6tpnps _tgu817qg _1k47pnps _g0lx1fxt _ys4e131l _7gp8h55r _1yvq10m5 _1vww10m5 _1rju10m5 _1v0lh55r _wmyy17qg _748n17qg _1mfn17qg _1d7e17qg _p2vr17qg _19o610m5 _kxov17qg _1np517qg _m2f517qg _1b9tpnps _1tq6pnps _1rd2pnps _1pbkpnps _k3lipnps _13zt131l _2g12fb2s _k86b10m5 _b5iy131l _gti3131l _1f0gpnps _9d3e17qg _qdiapnps _72uvpnps _13dgkb7n _170714ej _1i3h1txw _1huoidpf _1a9lidpf _20bqidpf _1oggidpf _bympidpf _9nnjidpf"
                                  data-testid="renderer-code-block"
                                  style="--ads-code-line-number-width: calc(1ch + 16px); --ads-highlighted-start-text: Highlight start; --ads-highlighted-end-text: Highlight end;"><code
                                    class="language-xml" style="white-space: pre;"><span
                                    data-testid="renderer-code-block-line-1" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="1"></span><span
                                    class="">1st attempt (fails) 
</span></span><span data-testid="renderer-code-block-line-2" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="2"></span>Wait 3 sec 
</span><span data-testid="renderer-code-block-line-3" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="3"></span>2nd attempt (fails) 
</span><span data-testid="renderer-code-block-line-4" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="4"></span>Wait 6 sec 
</span><span data-testid="renderer-code-block-line-5" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="5"></span>3rd attempt (fails) 
</span><span data-testid="renderer-code-block-line-6" data-ds--code--row="" class=""><span
                                    class="comment linenumber ds-line-number" data-ds--line-number="6"></span> Sent to Dead Letter Topic (DLT)</span></code></span>
                        </div>
                        <p data-renderer-start-pos="24758">Spring will <strong
                                data-renderer-mark="true">auto-create</strong> retry topics and the DLT unless you
                            override naming and handling.</p>
                        <p data-renderer-start-pos="24849">Retry the message 2 times (after 3s and 6s delays)</p>
                        <p data-renderer-start-pos="24901">Still fails?  Sent to <code
                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                data-renderer-mark="true">payment-topic-dlt</code></p>
                        <p data-renderer-start-pos="24943">The <code
                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                data-renderer-mark="true">@DltHandler</code> method handles it</p>
                        <h3 id="@DltHandler" data-renderer-start-pos="24978"><code
                                class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                data-renderer-mark="true">@DltHandler</code><span role="presentation"
                                                                                  class="heading-anchor-wrapper"></span></h3>
                        <span data-testid="visually-hidden-heading-anchor"
                              class="_ca0qidpf _u5f3idpf _n3tdidpf _19bvidpf _19itidpf _1reo15vq _18m915vq _1bsbt94y _4t3it94y _kqswstnw _ogto7mnp _uiztglyw _o5721q9c"><span
                                role="presentation" class="heading-anchor-wrapper"></span></span>
                        <p data-renderer-start-pos="24991">This method handles messages that failed <strong
                                data-renderer-mark="true">even after retries</strong>.</p>
                        <ul class="ak-ul" data-indent-level="1">
                            <li><p data-renderer-start-pos="25055">Messages from the <strong data-renderer-mark="true">Dead
                                Letter Topic</strong> will be sent to this method.</p></li>
                            <li><p data-renderer-start-pos="25123">You can log them, alert teams, store in DB, etc.</p>
                            </li>
                            <li><p data-renderer-start-pos="25175">Spring Kafka (if not configured otherwise) will
                                auto-create:</p>
                                <ul class="ak-ul" data-indent-level="2">
                                    <li><p data-renderer-start-pos="25239">Retry topics like:<br><code
                                            class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                            data-renderer-mark="true">payment-topic-retry-0</code>, <code
                                            class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                            data-renderer-mark="true">payment-topic-retry-1</code>, etc.</p></li>
                                    <li><p data-renderer-start-pos="25312">Dead-letter topic:<br><code
                                            class="_ca0qyh40 _u5f3m5ip _n3tdyh40 _19bvm5ip _2rko1sit _11c81u0j _1reo1wug _18m91wug _1dqoglyw _1e0c1nu9 _bfhktkvp _16d9qvcn _syaz1fxt _vwz41kw7 _1i4q1hna _o5721jtm"
                                            data-renderer-mark="true">payment-topic-dlt</code></p></li>
                                </ul>
                                <p data-renderer-start-pos="25352">You can override topic names if needed.</p></li>
                        </ul>
                    </div>
                </div>
            </article>
        </div>
        <button onclick="topFunction()" id="myBtn" title="Go to top">
            <img height="30" width="30" src="./scripts/images/top.jpeg" alt="Top"/>
        </button>
    </main>
</div>
</body>
<div id="footer"></div>
<script src="./scripts/js/site.js"></script>
<script src="./scripts/js/main.js"></script>
</html>